(()=>{var e,t={64:()=>{function e(e){var t=e.src.split("/")[7],n=document.createElement("button");n.type="button",n.classList.add("destroy-image-btn"),n.dataset.id=t,n.innerHTML='<i class="fas fa-trash"></i>',e.nextElementSibling&&"BUTTON"==e.nextElementSibling.tagName&&e.nextElementSibling.classList.contains("destroy-image-btn")&&e.nextElementSibling.remove(),e.after(n),n.addEventListener("click",(function(e){e.preventDefault,function(e,t){var n=document.querySelector('meta[name="csrf-token"]').getAttribute("content");confirm("Удалить изображение?")&&fetch("/admin/ajax/destroyImage",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8","X-CSRF-TOKEN":n},body:JSON.stringify({id:e})}).then((function(e){e.text().then((function(e){console.log("result:",e)})),t.parentElement.classList.contains("portfolio-gallery-image")?t.parentElement.remove():t.parentElement.querySelector("img").remove(),t.remove()}))}(t,n)}))}function t(e){var t=e.querySelector('[data-action="saveQuestion"]');t.addEventListener("click",(function(){if(!confirm("Сохранить вопрос?"))return;var a=new FormData,o=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),r=t.dataset.id,i=e.querySelector('[data-name="name"]').value,l=e.querySelector('[data-name="answer"]').value,c=e.querySelector('[data-name="sort"]').value,d=t.dataset.faq;c||(c=1,e.querySelector('[data-name="sort"]').value=c);i&&l&&c&&(a.append("id",r),a.append("name",i),a.append("answer",l),a.append("sort",c),a.append("faq_id",d),fetch("/admin/ajax/saveQuestion",{method:"POST",headers:{"X-CSRF-TOKEN":o},body:a}).then((function(e){e.text().then((function(e){console.log("result:",JSON.parse(e)),n.dataset.id=JSON.parse(e).id}))})))}));var n=e.querySelector('[data-action="removeQuestion"]');n.addEventListener("click",(function(){if(!confirm("Удалить вопрос?"))return;var e=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),t=n.dataset.id;t&&fetch("/admin/ajax/removeQuestion",{method:"POST",headers:{"X-CSRF-TOKEN":e},body:t}).then((function(e){e.text().then((function(e){console.log("result:",e);var t=n.closest(".question");t&&t.remove()}))}))}))}document.addEventListener("DOMContentLoaded",(function(){var n,a,o;!function(){var t=document.querySelector('[data-action="updateAvatar"]');if(t){var n=t.closest(".input-group").querySelector(".custom-file-input"),a=t.closest(".input-group").querySelector(".custom-file-label");n&&t.addEventListener("click",(function(){if(0==n.files.length&&alert("Выберите файл"),n.files.length>0){if(!confirm("Будет загружено новое изображение. Продолжить?"))return;var o=new FormData,r=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),i=t.dataset.id,l=t.dataset.type,c=n.files[0];i&&l&&c&&(o.append("page_id",i),o.append("page_type",l),o.append("avatar_file",c),fetch("/admin/ajax/updateAvatar",{method:"POST",headers:{"X-CSRF-TOKEN":r},body:o}).then((function(t){t.text().then((function(t){!function(t){var n=document.querySelector(".avatar");if(n){n.innerHTML="";var a=document.createElement("img");a.src=t,n.append(a),e(a)}}(t),n.value="",a&&(a.innerText="Файл не выбран")}))})))}}))}}(),(n=document.querySelectorAll('img[data-function="destroy"]'))&&n.forEach((function(t){e(t)})),function(){if(!document.getElementById("portfolio-gallery"))return;var t=document.getElementById("portfolio-gallery"),n=t.cloneNode(!0),a=document.getElementById("portfolio-gallery-buttons"),o=a.querySelector('[data-action="sort"]'),r=a.querySelector('[data-action="save"]'),i=a.querySelector('[data-action="cancel"]');function l(){t=document.getElementById("portfolio-gallery"),n=t.cloneNode(!0)}function c(){t.querySelectorAll(".portfolio-gallery-image").forEach((function(e){e.draggable=!0,e.querySelectorAll("img").forEach((function(e){e.style.pointerEvents="none"})),e.querySelectorAll("button").forEach((function(e){e.style.display="none"})),e.addEventListener("dragstart",u),e.addEventListener("dragover",f),e.addEventListener("dragend",m)})),o.setAttribute("disabled",""),r.removeAttribute("disabled"),i.removeAttribute("disabled")}function d(n){t.replaceWith(n),s(),l(),t.querySelectorAll(".portfolio-gallery-image").forEach((function(t){t.querySelectorAll("img").forEach((function(t){e(t)}))}))}function s(){t.querySelectorAll(".portfolio-gallery-image").forEach((function(e){e.removeAttribute("draggable"),e.querySelectorAll("img").forEach((function(e){e.removeAttribute("style")})),e.querySelectorAll("button").forEach((function(e){e.removeAttribute("style")})),e.removeEventListener("dragstart",u),e.removeEventListener("dragover",f),e.removeEventListener("dragend",m)})),o.removeAttribute("disabled"),r.setAttribute("disabled",""),i.setAttribute("disabled","")}function u(e){e.target.classList.add("selected")}function m(e){e.target.classList.remove("selected")}function f(e){e.preventDefault();var n=t.querySelector(".selected"),a=e.target;if(n!==a&&a.classList.contains("portfolio-gallery-image")){var o=a===n.nextElementSibling?a.nextElementSibling:a;t.insertBefore(n,o)}}function v(){var e=[];t.querySelectorAll(".portfolio-gallery-image").forEach((function(t,n){var a=t.querySelector("img").src.split("/")[7];e.push({id:a,sort:n})}));var n=document.querySelector('meta[name="csrf-token"]').getAttribute("content");fetch("/admin/ajax/saveGallerySort",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8","X-CSRF-TOKEN":n},body:JSON.stringify(e)}).then((function(e){e.text().then((function(e){console.log("result:",e)}))})),s(),l()}o.addEventListener("click",c),r.addEventListener("click",v),i.addEventListener("click",(function(){d(n)}))}(),function(){var t=document.querySelector('[data-action="addImagesToPortfolio"]');if(t){var n=t.closest(".input-group").querySelector(".custom-file-input"),a=t.closest(".input-group").querySelector(".custom-file-label");n&&t.addEventListener("click",(function(){if(0==n.files.length&&alert("Выберите файлы"),n.files.length>0){if(!confirm("Продолжить?"))return;var o=new FormData,r=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),i=t.dataset.id,l=t.dataset.type,c=n.files;if(i&&l&&c){o.append("page_id",i),o.append("page_type",l);for(var d=0;d<c.length;d++)o.append("images[".concat(d,"]"),c[d]);fetch("/admin/ajax/addImagesToPortfolio",{method:"POST",headers:{"X-CSRF-TOKEN":r},body:o}).then((function(t){t.text().then((function(t){var o,r;o=JSON.parse(t),(r=document.getElementById("portfolio-gallery"))&&o.forEach((function(t){var n=document.createElement("img");n.src=t,n.setAttribute("width","152px"),n.setAttribute("height","auto"),n.setAttribute("data-function","destroy");var a=document.createElement("div");a.classList.add("portfolio-gallery-image","mr-2","mt-1","mb-1","d-block","position-relative"),a.append(n),r.append(a),e(n)})),n.value="",a&&(a.innerText="Файлы не выбраны")}))}))}}}))}}(),(a=document.querySelectorAll(".question")).length>0&&a.forEach((function(e){t(e)})),function(){var e=document.querySelector(".questions"),n=document.querySelector('button[data-action="addNewQuestion"]');if(e&&n){var a=n.dataset.faq;n.addEventListener("click",(function(){var n=Math.floor(9999*Math.random()),o=document.createElement("div");o.classList.add("question","col-md-6"),o.innerHTML='\n                <div class="card">\n                    <div class="card-body">\n                        <div class="form-group">\n                            <label for="question_name['.concat(n,']">Название</label>\n                            <input type="text" class="form-control" id="question_name[').concat(n,']"\n                                name="questions[').concat(n,'][name]" data-name="name">\n                        </div>\n                        <div class="form-group">\n                            <label for="question_answer[').concat(n,']">Ответ</label>\n                            <textarea id="question_answer[').concat(n,']" class="form-control" rows="3" name="questions[').concat(n,'][answer]" data-name="answer"></textarea>\n                        </div>\n                        <div class="row">\n                            <div class="col-md-5">\n                                <div class="form-group">\n                                    <label for="questions[').concat(n,'][sort]">Ключ сортировки</label>\n                                    <input type="text" class="form-control"\n                                        id="questions[').concat(n,'][sort]" name="questions[').concat(n,'][sort]" data-name="sort">\n                                </div>\n                            </div>\n                            <div class="col-md-5 d-flex align-items-end">\n                                <div class="form-group w-100">\n                                    <button type="button" class="btn btn-block btn-primary"\n                                        data-action="saveQuestion"\n                                        data-id="0"\n                                        data-faq="').concat(a,'">\n                                        Сохранить\n                                    </button>\n                                </div>\n                            </div>\n                            <div class="col-md-2 d-flex align-items-end">\n                                <div class="form-group w-100">\n                                    <button type="button" class="btn btn-block btn-danger"\n                                        data-action="removeQuestion"\n                                        data-id="{').concat(n,'}">\n                                        Удалить\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            '),e.append(o),t(o)}))}}(),bsCustomFileInput.init(),tinymce.init({selector:".editor",plugins:"file-manager table link lists code fullscreen",Flmngr:{apiKey:"FLMNFLMN",urlFileManager:"/flmngr",urlFiles:"/storage/upload/files"},relative_urls:!1,extended_valid_elements:"*[*]",height:"500px",toolbar:["bold italic underline | alignleft aligncenter alignright alignjustify |  bullist numlist outdent indent | link blockquote table | code "],contextmenu:"undo redo | cut copy paste | inserttable",promotion:!1,language:"ru"}),(o=document.querySelectorAll(".gallery-item")).length>0&&o.forEach((function(e){!function(e){var t=e.querySelector('[data-action="removeGalleryItem"]');function n(){if(confirm("Удалить изображение?")){var e=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),n=t.dataset.id;n&&fetch("/admin/ajax/removeGalleryItem",{method:"POST",headers:{"X-CSRF-TOKEN":e},body:n}).then((function(e){e.text().then((function(e){console.log("result:",e);var n=t.closest(".gallery-item");n&&n.remove()}))}))}}t.addEventListener("click",n)}(e)}))}))},357:()=>{},458:()=>{}},n={};function a(e){var o=n[e];if(void 0!==o)return o.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,a),r.exports}a.m=t,e=[],a.O=(t,n,o,r)=>{if(!n){var i=1/0;for(s=0;s<e.length;s++){for(var[n,o,r]=e[s],l=!0,c=0;c<n.length;c++)(!1&r||i>=r)&&Object.keys(a.O).every((e=>a.O[e](n[c])))?n.splice(c--,1):(l=!1,r<i&&(i=r));if(l){e.splice(s--,1);var d=o();void 0!==d&&(t=d)}}return t}r=r||0;for(var s=e.length;s>0&&e[s-1][2]>r;s--)e[s]=e[s-1];e[s]=[n,o,r]},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={567:0,364:0,552:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var o,r,[i,l,c]=n,d=0;if(i.some((t=>0!==e[t]))){for(o in l)a.o(l,o)&&(a.m[o]=l[o]);if(c)var s=c(a)}for(t&&t(n);d<i.length;d++)r=i[d],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(s)},n=self.webpackChunk=self.webpackChunk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),a.O(void 0,[364,552],(()=>a(64))),a.O(void 0,[364,552],(()=>a(357)));var o=a.O(void 0,[364,552],(()=>a(458)));o=a.O(o)})();
//# sourceMappingURL=admin.js.map